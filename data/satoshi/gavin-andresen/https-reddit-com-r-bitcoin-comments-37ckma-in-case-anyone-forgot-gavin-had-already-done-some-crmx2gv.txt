code is on github, I rebased my mega locks branch, feel free to run it yourself...